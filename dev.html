<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>X4A Autonomous Agents Market API</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .nav-link { @apply px-2 py-1 border border-gray-300 rounded-md text-xs font-semibold text-gray-700 hover:text-blue-600 hover:bg-gray-100 transition-colors whitespace-nowrap; }
    .code-block { @apply bg-gray-900 text-white p-4 rounded-lg overflow-x-auto text-sm; }
    .kbd { @apply inline-block px-2 py-0.5 text-xs rounded bg-gray-100 border; }
    .card { @apply bg-white rounded-xl shadow-md border border-gray-200 p-5; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <div id="fade" class="fixed inset-0 bg-white opacity-0 pointer-events-none transition-opacity duration-500"></div>
  <header class="sticky top-0 bg-white/90 text-gray-800 backdrop-blur-md shadow-sm z-50 border-b border-gray-200">
    <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex-shrink-0 flex items-center">
          <span class="text-2xl font-extrabold text-blue-600">X4A</span>
          <span class="ml-3 text-xl font-extrabold text-gray-900">Autonomous Agents Market API</span>
        </div>
        <div class="hidden sm:flex sm:space-x-2">
          <a href="#overview" class="nav-link">Overview</a>
          <a href="#quickstart" class="nav-link">Quickstart</a>
          <a href="#endpoints" class="nav-link">Endpoints</a>
          <a href="#x402" class="nav-link">X402</a>
          <a href="#perp" class="nav-link">Perp</a>
          <a href="#auth" class="nav-link">Auth</a>
          <a href="/" class="bg-blue-600 text-white px-3 py-1 rounded-md font-semibold text-xs hover:bg-blue-700 transition-colors duration-200 whitespace-nowrap" target="_blank" rel="noopener noreferrer">Main Site</a>
        </div>
      </div>
    </nav>
  </header>

  <main class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">
    <section id="overview" class="mb-12">
      <h1 class="text-4xl font-bold tracking-tight text-gray-900 mb-4">What this is</h1>
      <p class="text-gray-700 text-lg">
        This page documents the <strong>X4A Autonomous Agents Market API</strong> — the public-facing interface for token data,
        Grok-powered agent insights, the HTTP&nbsp;402 paywall flow, and the Perp simulator endpoints used under the hood of the
        Dev Tools. Same look, less clutter. No “demo mode” labels.
      </p>
    </section>

    <section id="quickstart" class="mb-12">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card">
          <h2 class="text-2xl font-semibold mb-3">Quickstart</h2>
          <ol class="list-decimal pl-5 space-y-2 text-gray-700">
            <li>Base URL: <span class="kbd">/api</span></li>
            <li>JSON everywhere. <span class="kbd">Content-Type: application/json</span></li>
            <li>On purchase/activation, expect <span class="kbd">HTTP 402</span> with Solana Pay details.</li>
            <li>Server-Sent Events for live portfolio updates: <span class="kbd">/events?wallet=&lt;address&gt;</span></li>
          </ol>
        </div>
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Fetch example</h3>
          <div class="code-block"><pre><code>fetch('/api/x4a-data')
  .then(r =&gt; r.json())
  .then(d =&gt; console.log('Price USD:', d.token.usdPrice));</code></pre></div>
        </div>
      </div>
    </section>

    <section id="endpoints" class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Core Endpoints</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Token &amp; Agents</h3>
          <ul class="list-disc pl-5 text-gray-700 space-y-2">
            <li><span class="kbd">GET /api/x4a-data</span> — price, mcap, liquidity, holders, txns</li>
            <li><span class="kbd">POST /api/grok</span> — <em>{ id, type, query }</em> ⇒ Grok-like insights</li>
            <li><span class="kbd">POST /api/buy-agent</span> — triggers <span class="kbd">HTTP 402</span> Solana Pay flow</li>
          </ul>
        </div>
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Market Data</h3>
          <ul class="list-disc pl-5 text-gray-700 space-y-2">
            <li><span class="kbd">GET /api/candles?symbol=BTCUSDT&amp;interval=1m</span></li>
            <li><span class="kbd">GET /api/trades?symbol=BTCUSDT</span></li>
            <li><span class="kbd">GET /events?wallet=&lt;address&gt;</span> — SSE stream</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="x402" class="mb-12">
      <h2 class="text-3xl font-bold mb-4">X402 Protocol (Payments &amp; PDA)</h2>
      <p class="text-gray-700 mb-3">Selected endpoints used by the Dev Tools and agents:</p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Payments &amp; Validation</h3>
          <ul class="list-disc pl-5 text-gray-700 space-y-2">
            <li><span class="kbd">POST /api/x402/test</span> — simulate payment</li>
            <li><span class="kbd">POST /api/x402/validate</span> — validate receipt/signature</li>
            <li><span class="kbd">GET /api/x402/pda/escrow</span> — escrow balance check</li>
          </ul>
        </div>
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Swarm &amp; Bridge</h3>
          <ul class="list-disc pl-5 text-gray-700 space-y-2">
            <li><span class="kbd">GET /api/x4a/swarm/status</span> — counts/status</li>
            <li><span class="kbd">POST /api/x4a/evolution/sim</span> — merge/fork simulation</li>
            <li><span class="kbd">POST /api/x402/bridge/cross</span> — LayerZero/CCIP test</li>
          </ul>
        </div>
      </div>
      <div class="mt-6 card">
        <h4 class="text-lg font-semibold mb-2">Example: HTTP 402 flow</h4>
        <div class="code-block"><pre><code>const r = await fetch('/api/buy-agent', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ walletAddress: '&lt;yourWallet&gt;', agentId: 'X4A' })
});
if (r.status === 402) {
  const info = await r.json(); // contains tx or Solana Pay URL
  // handle signing &amp; submission here...
}</code></pre></div>
      </div>
    </section>

    <section id="perp" class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Perp Simulator (Under the Dev Tools)</h2>
      <p class="text-gray-700 mb-3">These power the under-the-hood trading sim you see in Dev Tools.</p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Portfolio &amp; Orders</h3>
          <div class="code-block"><pre><code>// GET /api/portfolio?wallet=Fg6PaF...sLnS
// POST /api/order { wallet, symbol, side: "buy"|"sell", qty }
</code></pre></div>
        </div>
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Real-time</h3>
          <div class="code-block"><pre><code>// GET /events?wallet=&lt;address&gt;
// Messages: { type: "snapshot" | "trade", data: ... }</code></pre></div>
        </div>
      </div>
    </section>

    <section id="auth" class="mb-16">
      <h2 class="text-3xl font-bold mb-4">Authentication &amp; Usage</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Who is this for?</h3>
          <p class="text-gray-700">Protocol integrators, market makers, explorers, and front-ends embedding agent data or
          triggering the paywall activation flow.</p>
          <ul class="list-disc pl-5 text-gray-700 mt-2 space-y-1">
            <li>Public read endpoints do not require keys</li>
            <li>Activation/payment endpoints respond with <span class="kbd">HTTP 402</span></li>
          </ul>
        </div>
        <div class="card">
          <h3 class="text-xl font-semibold mb-2">Best Practices</h3>
          <ul class="list-disc pl-5 text-gray-700 space-y-1">
            <li>Respect rate limits; cache token metrics for 10–30s</li>
            <li>Use SSE instead of polling for portfolio updates</li>
            <li>On 402, surface a clean Solana Pay UX and retry on nonce errors</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="border-t border-gray-200 py-6">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-sm text-gray-500">
      © X4A — Autonomous Agents Market API
    </div>
  </footer>

  <script>
    // subtle entry fade
    window.addEventListener('DOMContentLoaded', () => {
      const el = document.getElementById('fade');
      el.classList.remove('opacity-0');
      requestAnimationFrame(() => {
        el.classList.add('opacity-0');
      });
    });
  </script>
</body>
</html>
